{"ast":null,"code":"\"use strict\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar mobx_1 = require(\"mobx\");\n\nvar utils_1 = require(\"../internal/utils\");\n\nvar types_1 = require(\"./types\");\n\nfunction isArrayLike(x) {\n  return Array.isArray(x) || mobx_1.isObservableArray(x);\n}\n/**\n * Just a wrapper around the helpers for a set of FieldStates or FormStates\n */\n\n\nvar FormState =\n/** @class */\nfunction () {\n  function FormState(\n  /**\n   * SubItems can be any Validatable\n   */\n  $) {\n    var _this = this;\n\n    this.$ = $;\n    this.mode = 'object';\n    /** Get validatable objects from $ */\n\n    this.getValues = function () {\n      if (_this.mode === 'array') return _this.$;\n      if (_this.mode === 'map') return Array.from(_this.$.values());\n      var keys = Object.keys(_this.$);\n      return keys.map(function (key) {\n        return _this.$[key];\n      });\n    };\n\n    this.validating = false;\n    this._validators = [];\n\n    this.validators = function () {\n      var validators = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        validators[_i] = arguments[_i];\n      }\n\n      _this._validators = validators;\n      return _this;\n    };\n\n    this._error = '';\n    /**\n     * Resets all the fields in the form\n     */\n\n    this.reset = function () {\n      _this.getValues().map(function (v) {\n        return v.reset();\n      });\n    };\n    /**\n     * Auto validation\n     */\n\n\n    this.autoValidationEnabled = false;\n\n    this.enableAutoValidation = function () {\n      _this.autoValidationEnabled = true;\n\n      _this.getValues().forEach(function (x) {\n        return x.enableAutoValidation();\n      });\n    };\n\n    this.enableAutoValidationAndValidate = function () {\n      _this.enableAutoValidation();\n\n      return _this.validate();\n    };\n\n    this.disableAutoValidation = function () {\n      _this.autoValidationEnabled = false;\n\n      _this.getValues().forEach(function (x) {\n        return x.disableAutoValidation();\n      });\n    };\n    /**\n     * Composible field validation tracking\n     */\n\n\n    this.validatedSubFields = [];\n\n    this._on$ValidationPass = function () {};\n\n    this._on$Reinit = function () {};\n\n    this._setCompositionParent = function (config) {\n      _this._on$ValidationPass = function () {\n        return mobx_1.runInAction(config.on$ValidationPass);\n      };\n\n      _this._on$Reinit = function () {\n        return mobx_1.runInAction(config.on$Reinit);\n      };\n    };\n\n    this.mode = isArrayLike($) ? 'array' : utils_1.isMapLike($) ? 'map' : 'object';\n    /** If they didn't send in something observable make the local $ observable */\n\n    if (!mobx_1.isObservable(this.$)) {\n      this.$ = mobx_1.observable(this.$);\n    }\n  }\n  /**\n   * - Re-runs validation on all fields\n   * - returns `hasError`\n   * - if no error also return the validated values against each key.\n   */\n\n\n  FormState.prototype.validate = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var values, fieldsResult, done, error, res;\n\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.validating = true;\n            values = this.getValues();\n            return [4\n            /*yield*/\n            , Promise.all(values.map(function (value) {\n              return value.validate();\n            }))];\n\n          case 1:\n            fieldsResult = _a.sent();\n            done = mobx_1.runInAction(function () {\n              if (fieldsResult.some(function (f) {\n                return f.hasError;\n              })) {\n                _this.validating = false;\n                return true;\n              }\n\n              return false;\n            });\n            if (done) return [2\n            /*return*/\n            , {\n              hasError: true\n            }];\n            return [4\n            /*yield*/\n            , types_1.applyValidators(this.$, this._validators || [])];\n\n          case 2:\n            error = _a.sent();\n            res = mobx_1.runInAction(function () {\n              if (error != _this._error) {\n                _this._error = error;\n              }\n\n              _this.validating = false;\n              var hasError = !!error;\n\n              if (hasError) {\n                return {\n                  hasError: true\n                };\n              }\n\n              _this._on$ValidationPass();\n\n              return {\n                hasError: false,\n                value: _this.$\n              };\n            });\n            return [2\n            /*return*/\n            , res];\n        }\n      });\n    });\n  };\n\n  Object.defineProperty(FormState.prototype, \"hasError\", {\n    /**\n     * Does any field or form have an error\n     */\n    get: function () {\n      return this.hasFieldError || this.hasFormError;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FormState.prototype, \"hasFieldError\", {\n    /**\n     * Does any field have an error\n     */\n    get: function () {\n      return this.getValues().some(function (f) {\n        return f.hasError;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FormState.prototype, \"hasFormError\", {\n    /**\n     * Does form level validation have an error\n     */\n    get: function () {\n      return !!this._error;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * Call it when you are `reinit`ing child fields\n   */\n\n  FormState.prototype.clearFormError = function () {\n    this._error = '';\n  };\n\n  Object.defineProperty(FormState.prototype, \"fieldError\", {\n    /**\n     * Error from some sub field if any\n     */\n    get: function () {\n      var subItemWithError = this.getValues().find(function (f) {\n        return !!f.hasError;\n      });\n      return subItemWithError ? subItemWithError.error : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FormState.prototype, \"formError\", {\n    /**\n     * Error from form if any\n     */\n    get: function () {\n      return this._error;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FormState.prototype, \"error\", {\n    /**\n     * The first error from any sub (if any) or form error\n     */\n    get: function () {\n      return this.fieldError || this.formError;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(FormState.prototype, \"showFormError\", {\n    /**\n     * You should only show the form error if there are no field errors\n     */\n    get: function () {\n      return !this.hasFieldError && this.hasFormError;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * Composible fields (fields that work in conjuction with FormState)\n   */\n\n  FormState.prototype.compose = function () {\n    var _this = this;\n\n    var values = this.getValues();\n    values.forEach(function (value) {\n      return value._setCompositionParent({\n        on$Reinit: mobx_1.action(function () {\n          _this.validatedSubFields = _this.validatedSubFields.filter(function (v) {\n            return v !== value;\n          });\n        }),\n        on$ValidationPass: mobx_1.action(function () {\n          /** Always clear the form error as its no longer relevant */\n          if (_this.hasFormError) {\n            _this.clearFormError();\n          }\n          /** Add the field to the validated sub fields */\n\n\n          if (_this.validatedSubFields.indexOf(value) === -1) {\n            _this.validatedSubFields.push(value);\n          }\n          /**\n           * Compose triggers an automatic self validation of the form based on this criteria\n           */\n\n\n          if (\n          /** If no field has error */\n          !_this.hasFieldError\n          /** And there isn't an active validation taking place */\n          && !_this.validating\n          /** And all subfields are validated */\n          && !_this.getValues().some(function (value) {\n            return _this.validatedSubFields.indexOf(value) === -1;\n          })) {\n            _this.validate();\n          }\n        })\n      });\n    });\n    return this;\n  };\n\n  __decorate([mobx_1.observable], FormState.prototype, \"validating\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"validators\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"validate\", null);\n\n  __decorate([mobx_1.observable], FormState.prototype, \"_error\", void 0);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"hasError\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"hasFieldError\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"hasFormError\", null);\n\n  __decorate([mobx_1.action], FormState.prototype, \"clearFormError\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"fieldError\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"formError\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"error\", null);\n\n  __decorate([mobx_1.computed], FormState.prototype, \"showFormError\", null);\n\n  __decorate([mobx_1.action], FormState.prototype, \"reset\", void 0);\n\n  __decorate([mobx_1.observable], FormState.prototype, \"autoValidationEnabled\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"enableAutoValidation\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"enableAutoValidationAndValidate\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"disableAutoValidation\", void 0);\n\n  __decorate([mobx_1.observable], FormState.prototype, \"validatedSubFields\", void 0);\n\n  __decorate([mobx_1.action], FormState.prototype, \"compose\", null);\n\n  __decorate([mobx_1.action], FormState.prototype, \"_setCompositionParent\", void 0);\n\n  return FormState;\n}();\n\nexports.FormState = FormState;","map":{"version":3,"sources":["/home/chef/Desktop/signer/node_modules/formstate/lib/core/formState.js"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","push","exports","mobx_1","require","utils_1","types_1","isArrayLike","x","Array","isArray","isObservableArray","FormState","$","_this","mode","getValues","from","values","keys","map","validating","_validators","validators","_i","_error","reset","autoValidationEnabled","enableAutoValidation","forEach","enableAutoValidationAndValidate","validate","disableAutoValidation","validatedSubFields","_on$ValidationPass","_on$Reinit","_setCompositionParent","config","runInAction","on$ValidationPass","on$Reinit","isMapLike","isObservable","observable","prototype","fieldsResult","error","res","_a","all","some","hasError","applyValidators","get","hasFieldError","hasFormError","enumerable","configurable","clearFormError","subItemWithError","find","fieldError","formError","compose","action","filter","indexOf","computed"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar mobx_1 = require(\"mobx\");\nvar utils_1 = require(\"../internal/utils\");\nvar types_1 = require(\"./types\");\nfunction isArrayLike(x) {\n    return Array.isArray(x) || mobx_1.isObservableArray(x);\n}\n/**\n * Just a wrapper around the helpers for a set of FieldStates or FormStates\n */\nvar FormState = /** @class */ (function () {\n    function FormState(\n    /**\n     * SubItems can be any Validatable\n     */\n    $) {\n        var _this = this;\n        this.$ = $;\n        this.mode = 'object';\n        /** Get validatable objects from $ */\n        this.getValues = function () {\n            if (_this.mode === 'array')\n                return _this.$;\n            if (_this.mode === 'map')\n                return Array.from(_this.$.values());\n            var keys = Object.keys(_this.$);\n            return keys.map(function (key) { return _this.$[key]; });\n        };\n        this.validating = false;\n        this._validators = [];\n        this.validators = function () {\n            var validators = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                validators[_i] = arguments[_i];\n            }\n            _this._validators = validators;\n            return _this;\n        };\n        this._error = '';\n        /**\n         * Resets all the fields in the form\n         */\n        this.reset = function () {\n            _this.getValues().map(function (v) { return v.reset(); });\n        };\n        /**\n         * Auto validation\n         */\n        this.autoValidationEnabled = false;\n        this.enableAutoValidation = function () {\n            _this.autoValidationEnabled = true;\n            _this.getValues().forEach(function (x) { return x.enableAutoValidation(); });\n        };\n        this.enableAutoValidationAndValidate = function () {\n            _this.enableAutoValidation();\n            return _this.validate();\n        };\n        this.disableAutoValidation = function () {\n            _this.autoValidationEnabled = false;\n            _this.getValues().forEach(function (x) { return x.disableAutoValidation(); });\n        };\n        /**\n         * Composible field validation tracking\n         */\n        this.validatedSubFields = [];\n        this._on$ValidationPass = function () { };\n        this._on$Reinit = function () { };\n        this._setCompositionParent = function (config) {\n            _this._on$ValidationPass = function () { return mobx_1.runInAction(config.on$ValidationPass); };\n            _this._on$Reinit = function () { return mobx_1.runInAction(config.on$Reinit); };\n        };\n        this.mode = isArrayLike($) ? 'array' : utils_1.isMapLike($) ? 'map' : 'object';\n        /** If they didn't send in something observable make the local $ observable */\n        if (!mobx_1.isObservable(this.$)) {\n            this.$ = mobx_1.observable(this.$);\n        }\n    }\n    /**\n     * - Re-runs validation on all fields\n     * - returns `hasError`\n     * - if no error also return the validated values against each key.\n     */\n    FormState.prototype.validate = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var values, fieldsResult, done, error, res;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.validating = true;\n                        values = this.getValues();\n                        return [4 /*yield*/, Promise.all(values.map(function (value) { return value.validate(); }))];\n                    case 1:\n                        fieldsResult = _a.sent();\n                        done = mobx_1.runInAction(function () {\n                            if (fieldsResult.some(function (f) { return f.hasError; })) {\n                                _this.validating = false;\n                                return true;\n                            }\n                            return false;\n                        });\n                        if (done)\n                            return [2 /*return*/, { hasError: true }];\n                        return [4 /*yield*/, types_1.applyValidators(this.$, this._validators || [])];\n                    case 2:\n                        error = _a.sent();\n                        res = mobx_1.runInAction(function () {\n                            if (error != _this._error) {\n                                _this._error = error;\n                            }\n                            _this.validating = false;\n                            var hasError = !!error;\n                            if (hasError) {\n                                return { hasError: true };\n                            }\n                            _this._on$ValidationPass();\n                            return { hasError: false, value: _this.$ };\n                        });\n                        return [2 /*return*/, res];\n                }\n            });\n        });\n    };\n    Object.defineProperty(FormState.prototype, \"hasError\", {\n        /**\n         * Does any field or form have an error\n         */\n        get: function () {\n            return this.hasFieldError || this.hasFormError;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FormState.prototype, \"hasFieldError\", {\n        /**\n         * Does any field have an error\n         */\n        get: function () {\n            return this.getValues().some(function (f) { return f.hasError; });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FormState.prototype, \"hasFormError\", {\n        /**\n         * Does form level validation have an error\n         */\n        get: function () {\n            return !!this._error;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Call it when you are `reinit`ing child fields\n     */\n    FormState.prototype.clearFormError = function () {\n        this._error = '';\n    };\n    Object.defineProperty(FormState.prototype, \"fieldError\", {\n        /**\n         * Error from some sub field if any\n         */\n        get: function () {\n            var subItemWithError = this.getValues().find(function (f) { return !!f.hasError; });\n            return subItemWithError ? subItemWithError.error : null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FormState.prototype, \"formError\", {\n        /**\n         * Error from form if any\n         */\n        get: function () {\n            return this._error;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FormState.prototype, \"error\", {\n        /**\n         * The first error from any sub (if any) or form error\n         */\n        get: function () {\n            return this.fieldError || this.formError;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FormState.prototype, \"showFormError\", {\n        /**\n         * You should only show the form error if there are no field errors\n         */\n        get: function () {\n            return !this.hasFieldError && this.hasFormError;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Composible fields (fields that work in conjuction with FormState)\n     */\n    FormState.prototype.compose = function () {\n        var _this = this;\n        var values = this.getValues();\n        values.forEach(function (value) { return value._setCompositionParent({\n            on$Reinit: mobx_1.action(function () {\n                _this.validatedSubFields = _this.validatedSubFields.filter(function (v) { return v !== value; });\n            }),\n            on$ValidationPass: mobx_1.action(function () {\n                /** Always clear the form error as its no longer relevant */\n                if (_this.hasFormError) {\n                    _this.clearFormError();\n                }\n                /** Add the field to the validated sub fields */\n                if (_this.validatedSubFields.indexOf(value) === -1) {\n                    _this.validatedSubFields.push(value);\n                }\n                /**\n                 * Compose triggers an automatic self validation of the form based on this criteria\n                 */\n                if (\n                /** If no field has error */\n                !_this.hasFieldError\n                    /** And there isn't an active validation taking place */\n                    && !_this.validating\n                    /** And all subfields are validated */\n                    && !_this.getValues().some(function (value) { return _this.validatedSubFields.indexOf(value) === -1; })) {\n                    _this.validate();\n                }\n            })\n        }); });\n        return this;\n    };\n    __decorate([\n        mobx_1.observable\n    ], FormState.prototype, \"validating\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"validators\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"validate\", null);\n    __decorate([\n        mobx_1.observable\n    ], FormState.prototype, \"_error\", void 0);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"hasError\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"hasFieldError\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"hasFormError\", null);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"clearFormError\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"fieldError\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"formError\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"error\", null);\n    __decorate([\n        mobx_1.computed\n    ], FormState.prototype, \"showFormError\", null);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"reset\", void 0);\n    __decorate([\n        mobx_1.observable\n    ], FormState.prototype, \"autoValidationEnabled\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"enableAutoValidation\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"enableAutoValidationAndValidate\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"disableAutoValidation\", void 0);\n    __decorate([\n        mobx_1.observable\n    ], FormState.prototype, \"validatedSubFields\", void 0);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"compose\", null);\n    __decorate([\n        mobx_1.action\n    ], FormState.prototype, \"_setCompositionParent\", void 0);\n    return FormState;\n}());\nexports.FormState = FormState;\n"]},"metadata":{},"sourceType":"script"}