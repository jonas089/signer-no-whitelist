{"ast":null,"code":"import _regeneratorRuntime from\"/home/chef/Desktop/signer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/chef/Desktop/signer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/chef/Desktop/signer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/chef/Desktop/signer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _applyDecoratedDescriptor from\"/home/chef/Desktop/signer/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";var _class;import{computed}from'mobx';import{browser}from'webextension-polyfill-ts';var ConnectSignerContainer=(_class=/*#__PURE__*/function(){function ConnectSignerContainer(backgroundManager,appState){_classCallCheck(this,ConnectSignerContainer);this.backgroundManager=backgroundManager;this.appState=appState;}_createClass(ConnectSignerContainer,[{key:\"connectionStatus\",get:function get(){return this.appState.connectionStatus;}},{key:\"connectionRequested\",get:function get(){return this.appState.connectionRequested;}},{key:\"connectToSite\",value:function(){var _connectToSite=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.backgroundManager.connectToSite(url);case 2:_context.next=4;return this.resetConnectionRequest();case 4:case\"end\":return _context.stop();}}},_callee,this);}));function connectToSite(_x){return _connectToSite.apply(this,arguments);}return connectToSite;}()},{key:\"disconnectFromSite\",value:function(){var _disconnectFromSite=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(site){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.backgroundManager.disconnectFromSite(site);case 2:_context2.next=4;return this.resetConnectionRequest();case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function disconnectFromSite(_x2){return _disconnectFromSite.apply(this,arguments);}return disconnectFromSite;}()},{key:\"removeSite\",value:function(){var _removeSite=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.backgroundManager.removeSite(url);case 2:_context3.next=4;return this.resetConnectionRequest();case 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function removeSite(_x3){return _removeSite.apply(this,arguments);}return removeSite;}()},{key:\"resetConnectionRequest\",value:function(){var _resetConnectionRequest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.backgroundManager.resetConnectionRequest();case 2:case\"end\":return _context4.stop();}}},_callee4,this);}));function resetConnectionRequest(){return _resetConnectionRequest.apply(this,arguments);}return resetConnectionRequest;}()},{key:\"cancel\",value:function(){var _cancel=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.resetConnectionRequest();case 2:_context5.next=4;return this.closeWindow();case 4:case\"end\":return _context5.stop();}}},_callee5,this);}));function cancel(){return _cancel.apply(this,arguments);}return cancel;}()},{key:\"open\",value:function(){var _open=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.openWindow();case 2:case\"end\":return _context6.stop();}}},_callee6,this);}));function open(){return _open.apply(this,arguments);}return open;}()},{key:\"closeWindow\",value:function(){var _closeWindow=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var views,popup;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return browser.extension.getViews();case 2:views=_context7.sent;popup=views[1].window;popup.close();case 5:case\"end\":return _context7.stop();}}},_callee7);}));function closeWindow(){return _closeWindow.apply(this,arguments);}return closeWindow;}()},{key:\"openWindow\",value:function(){var _openWindow=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var views,popup;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return browser.extension.getViews();case 2:views=_context8.sent;popup=views[1].window;popup.open();case 5:case\"end\":return _context8.stop();}}},_callee8);}));function openWindow(){return _openWindow.apply(this,arguments);}return openWindow;}()},{key:\"connectedSites\",get:function get(){return this.appState.connectedSites;}},{key:\"currentTab\",get:function get(){return this.appState.currentTab;}// Is the current site injected with the content script?\n// And therefore is it a valid integrated client.\n// Based on the list of URLs from the extension manifest.json\n},{key:\"isIntegratedSite\",value:function(){var _isIntegratedSite=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(hostname){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return this.backgroundManager.isIntegratedSite(hostname);case 2:return _context9.abrupt(\"return\",_context9.sent);case 3:case\"end\":return _context9.stop();}}},_callee9,this);}));function isIntegratedSite(_x4){return _isIntegratedSite.apply(this,arguments);}return isIntegratedSite;}()},{key:\"integratedSite\",get:function get(){return this.appState.isIntegratedSite;}}]);return ConnectSignerContainer;}(),(_applyDecoratedDescriptor(_class.prototype,\"connectionStatus\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"connectionStatus\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"connectionRequested\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"connectionRequested\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"connectedSites\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"connectedSites\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"currentTab\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"currentTab\"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,\"integratedSite\",[computed],Object.getOwnPropertyDescriptor(_class.prototype,\"integratedSite\"),_class.prototype)),_class);export default ConnectSignerContainer;","map":{"version":3,"sources":["/home/chef/Desktop/signer/src/popup/container/ConnectSignerContainer.ts"],"names":["computed","browser","ConnectSignerContainer","backgroundManager","appState","connectionStatus","connectionRequested","url","connectToSite","resetConnectionRequest","site","disconnectFromSite","removeSite","closeWindow","openWindow","extension","getViews","views","popup","window","close","open","connectedSites","currentTab","hostname","isIntegratedSite"],"mappings":"4uBAEA,OAASA,QAAT,KAAyB,MAAzB,CACA,OAASC,OAAT,KAAwB,0BAAxB,C,GAEMC,CAAAA,sB,iCACJ,gCACUC,iBADV,CAEUC,QAFV,CAGE,mDAFQD,iBAER,CAFQA,iBAER,MADQC,QACR,CADQA,QACR,CAAE,C,iEAEJ,cACuB,CACrB,MAAO,MAAKA,QAAL,CAAcC,gBAArB,CACD,C,iCAED,cAC0B,CACxB,MAAO,MAAKD,QAAL,CAAcE,mBAArB,CACD,C,mHAED,iBAAoBC,GAApB,wIACQ,MAAKJ,iBAAL,CAAuBK,aAAvB,CAAqCD,GAArC,CADR,8BAEQ,MAAKE,sBAAL,EAFR,4D,gOAKA,kBAAyBC,IAAzB,6IACQ,MAAKP,iBAAL,CAAuBQ,kBAAvB,CAA0CD,IAA1C,CADR,+BAEQ,MAAKD,sBAAL,EAFR,8D,gOAKA,kBAAiBF,GAAjB,6IACQ,MAAKJ,iBAAL,CAAuBS,UAAvB,CAAkCL,GAAlC,CADR,+BAEQ,MAAKE,sBAAL,EAFR,8D,gOAKA,+JACQ,MAAKN,iBAAL,CAAuBM,sBAAvB,EADR,8D,iOAIA,+JACQ,MAAKA,sBAAL,EADR,+BAEQ,MAAKI,WAAL,EAFR,8D,6KAKA,+JACQ,MAAKC,UAAL,EADR,8D,qLAIA,+KACoBb,CAAAA,OAAO,CAACc,SAAR,CAAkBC,QAAlB,EADpB,QACMC,KADN,gBAEMC,KAFN,CAEcD,KAAK,CAAC,CAAD,CAAL,CAASE,MAFvB,CAGED,KAAK,CAACE,KAAN,GAHF,wD,wMAMA,+KACoBnB,CAAAA,OAAO,CAACc,SAAR,CAAkBC,QAAlB,EADpB,QACMC,KADN,gBAEMC,KAFN,CAEcD,KAAK,CAAC,CAAD,CAAL,CAASE,MAFvB,CAGED,KAAK,CAACG,IAAN,GAHF,wD,oHAMA,cACqB,CACnB,MAAO,MAAKjB,QAAL,CAAckB,cAArB,CACD,C,wBAED,cACiB,CACf,MAAO,MAAKlB,QAAL,CAAcmB,UAArB,CACD,CAED;AACA;AACA;yHACA,kBAAuBC,QAAvB,6IACe,MAAKrB,iBAAL,CAAuBsB,gBAAvB,CAAwCD,QAAxC,CADf,sH,yIAIA,cACqB,CACnB,MAAO,MAAKpB,QAAL,CAAcqB,gBAArB,CACD,C,sGAtEAzB,Q,2JAKAA,Q,yJA6CAA,Q,gJAKAA,Q,gJAYAA,Q,gGAMH,cAAeE,CAAAA,sBAAf","sourcesContent":["import { AppState } from '../../lib/MemStore';\nimport { BackgroundManager } from '../BackgroundManager';\nimport { computed } from 'mobx';\nimport { browser } from 'webextension-polyfill-ts';\n\nclass ConnectSignerContainer {\n  constructor(\n    private backgroundManager: BackgroundManager,\n    private appState: AppState\n  ) {}\n\n  @computed\n  get connectionStatus() {\n    return this.appState.connectionStatus;\n  }\n\n  @computed\n  get connectionRequested() {\n    return this.appState.connectionRequested;\n  }\n\n  async connectToSite(url?: string) {\n    await this.backgroundManager.connectToSite(url);\n    await this.resetConnectionRequest();\n  }\n\n  async disconnectFromSite(site?: string) {\n    await this.backgroundManager.disconnectFromSite(site);\n    await this.resetConnectionRequest();\n  }\n\n  async removeSite(url: string) {\n    await this.backgroundManager.removeSite(url);\n    await this.resetConnectionRequest();\n  }\n\n  async resetConnectionRequest() {\n    await this.backgroundManager.resetConnectionRequest();\n  }\n\n  async cancel() {\n    await this.resetConnectionRequest();\n    await this.closeWindow();\n  }\n\n  async open() {\n    await this.openWindow();\n  }\n\n  private async closeWindow() {\n    let views = await browser.extension.getViews();\n    let popup = views[1].window;\n    popup.close();\n  }\n\n  private async openWindow() {\n    let views = await browser.extension.getViews();\n    let popup = views[1].window;\n    popup.open();\n  }\n\n  @computed\n  get connectedSites() {\n    return this.appState.connectedSites;\n  }\n\n  @computed\n  get currentTab() {\n    return this.appState.currentTab;\n  }\n\n  // Is the current site injected with the content script?\n  // And therefore is it a valid integrated client.\n  // Based on the list of URLs from the extension manifest.json\n  async isIntegratedSite(hostname: string) {\n    return await this.backgroundManager.isIntegratedSite(hostname);\n  }\n\n  @computed\n  get integratedSite() {\n    return this.appState.isIntegratedSite;\n  }\n}\n\nexport default ConnectSignerContainer;\n"]},"metadata":{},"sourceType":"module"}